<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
    <style>
      :root {
        --primary-green: #005A31;
        --secondary-green: #4CAF50;
        --accent-blue: #007bff;
        --background-light: #f4f8f7;
        --text-dark: #333;
        --border-light: #ddd;
        --warning-yellow: #ffc107;
        --danger-red: #dc3545;
      }

      body { 
        font-family: 'Sarabun', sans-serif; 
        background-color: var(--background-light); 
        color: var(--text-dark); 
        margin: 0;
        padding: 10px;
        display: flex;
        justify-content: center;
        align-items: flex-start;
        min-height: 100vh;
      }
      .container { 
        width: 100%;
        max-width: 700px; 
        margin: 20px auto; 
        background: white; 
        padding: 25px; 
        border-radius: 12px; 
        box-shadow: 0 6px 20px rgba(0,0,0,0.08); 
        position: relative;
        box-sizing: border-box;
      }
      .nav-button { 
        position: absolute; 
        top: 20px; 
        right: 20px; 
        background-color: #6c757d; 
        color: white; 
        padding: 8px 15px; 
        text-decoration: none; 
        border-radius: 5px; 
        font-size: 0.9em; 
        transition: background-color 0.3s; 
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }
      .nav-button:hover {
        background-color: #5a6268;
      }
      h2 { 
        color: var(--primary-green); 
        border-bottom: 3px solid var(--secondary-green); 
        padding-bottom: 10px; 
        font-size: 1.6em; 
        margin-top: 0;
      }
      
      .btn-group {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 15px;
      }
      .btn-group button { 
        background-color: var(--secondary-green); 
        color: white; 
        padding: 12px 16px; 
        border: none; 
        cursor: pointer; 
        border-radius: 8px; 
        font-size: 1em; 
        font-family: 'Sarabun', sans-serif;
        transition: all 0.3s ease; 
        flex-grow: 1; 
        box-shadow: 0 2px 5px rgba(0,0,0,0.15);
      }
      .btn-group button:hover { 
        background-color: #45a049; 
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      }
      .btn-group button.active { 
        background-color: #00796b; 
        box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
        transform: translateY(0);
      }
      
      .sub-btn-group { 
        padding-left: 15px; 
        margin-top: 10px; 
        border-left: 3px solid var(--secondary-green); 
        display: none; /* Initially hidden */
        flex-wrap: wrap; 
        gap: 8px; 
      }
      .sub-btn-group button { 
        background: #e8f5e9;
        border: 1px solid var(--secondary-green);
        color: var(--primary-green); 
        font-weight: bold; 
        font-size: 0.9em; 
        padding: 10px 14px; 
        flex-grow: 1;
        border-radius: 8px;
        cursor: pointer;
        font-family: 'Sarabun', sans-serif;
        transition: all 0.3s ease;
      }
      .sub-btn-group button:hover {
        background: #c8e6c9;
      }
      .sub-btn-group button.active { 
        background: var(--primary-green);
        color: white; 
        border-color: var(--primary-green); 
      }
      
      .input-group { 
        display: none; /* Initially hidden */
        margin-top: 20px; 
        padding: 20px; 
        border: 1px solid var(--border-light); 
        border-radius: 8px; 
        background-color: #fafcfa; 
      }
      label { 
        display: block; 
        margin-bottom: 8px; 
        font-weight: bold; 
        color: #555;
      }
      input[type="number"], input[type="date"], select { 
        width: 100%; 
        padding: 12px; 
        margin-bottom: 10px; 
        border: 1px solid #ccc; 
        border-radius: 4px; 
        box-sizing: border-box; 
        font-size: 1em; 
        font-family: 'Sarabun', sans-serif;
      }
      .submit-btn { 
        background-color: var(--accent-blue); 
        color: white; 
        padding: 14px 20px; 
        border: none; 
        border-radius: 8px; 
        cursor: pointer; 
        width: 100%; 
        font-size: 1.2em; 
        margin-top: 20px; 
        font-family: 'Sarabun', sans-serif;
        transition: background-color 0.3s;
      }
      .submit-btn:hover {
        background-color: #0069d9;
      }
      
      /* Modal Styles */
      .modal-overlay { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.6); align-items: center; justify-content: center;}
      .modal-content { background-color: #fefefe; padding: 30px; border-radius: 10px; text-align: center; width: 90%; max-width: 350px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); display: none; }
      .spinner { border: 8px solid #f3f3f3; border-top: 8px solid var(--secondary-green); border-radius: 50%; width: 60px; height: 60px; animation: spin 1.5s linear infinite; margin: 0 auto 20px auto; }
      @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
      .modal-content h3 { color: var(--text-dark); margin-top: 0; }
      .modal-close-btn { background-color: var(--secondary-green); color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 1em; margin-top: 15px; }
      
      /* --- Leaf Success Graphic Styles --- */
      .co2-graphic { width: 120px; height: 100px; margin: 0 auto 15px auto; position: relative; }
      .co2-graphic .co2-cloud { fill: #a0aec0; transition: all 0.5s ease-in-out; animation: fadeOutAndShrink 1s ease-in-out 0.5s forwards; }
      .co2-graphic .leaf { fill: #48bb78; stroke: #2f855a; stroke-width: 2; transform-origin: 50% 100%; opacity: 0; animation: growIn 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) 1s forwards; }
      @keyframes fadeOutAndShrink { 0% { opacity: 1; transform: scale(1); } 100% { opacity: 0; transform: scale(0.1); } }
      @keyframes growIn { 0% { opacity: 0; transform: scale(0.2); } 100% { opacity: 1; transform: scale(1); } }
      
      .alert-modal-content { border-top: 5px solid var(--warning-yellow); }
      .alert-modal-content h3 { color: var(--danger-red); }
      .alert-icon { font-size: 4em; color: var(--warning-yellow); margin-bottom: 15px; }
      .alert-close-btn { background-color: var(--warning-yellow); }

      @media (max-width: 600px) {
        body { padding: 5px; }
        .container { padding: 15px; margin: 10px auto; }
        h2 { font-size: 1.3em; }
        .nav-button { padding: 6px 10px; font-size: 0.8em; top: 15px; right: 15px; }
        .btn-group, .sub-btn-group { flex-direction: column; }
      }
    </style>
  </head>
  <body>
    <div class="container">
     <a href="https://aase7en.github.io/CarbonFootprint/?page=dashboard" class="nav-button" target="_top">‡∏î‡∏π Dashboard üìä</a>
      <h2>‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Carbon Footprint ‡∏£‡∏û.‡∏≠‡∏∏‡∏ó‡∏±‡∏¢</h2>
      <p>‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏ú‡∏π‡πâ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô, ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡πÅ‡∏ú‡∏ô‡∏Å ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>

      <form id="dataForm" onsubmit="event.preventDefault(); submitForm();">
        <label for="dataDate">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å:</label>
        <input type="date" id="dataDate" name="dataDate" required>
        
        <label for="department">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å/‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô:</label>
        <select id="department" name="department" required>
            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å --</option>
            <option value="‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</option>
            <option value="‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•</option>
            <option value="‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ô‡∏≠‡∏Å">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ô‡∏≠‡∏Å</option>
            <option value="‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÉ‡∏ô">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÉ‡∏ô</option>
            <option value="‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡∏ô‡∏ï‡∏Å‡∏£‡∏£‡∏°">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡∏ô‡∏ï‡∏Å‡∏£‡∏£‡∏°</option>
            <option value="‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£‡∏£‡∏°">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£‡∏£‡∏°</option>
            <option value="‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏î‡πâ‡∏≤‡∏ô‡∏õ‡∏ê‡∏°‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏•‡∏∞‡∏≠‡∏á‡∏Ñ‡πå‡∏£‡∏ß‡∏°">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏î‡πâ‡∏≤‡∏ô‡∏õ‡∏ê‡∏°‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏•‡∏∞‡∏≠‡∏á‡∏Ñ‡πå‡∏£‡∏ß‡∏°</option>
            <option value="‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á">‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á</option>
            <option value="‡∏á‡∏≤‡∏ô‡∏¢‡∏≤‡∏ô‡∏û‡∏≤‡∏´‡∏ô‡∏∞">‡∏á‡∏≤‡∏ô‡∏¢‡∏≤‡∏ô‡∏û‡∏≤‡∏´‡∏ô‡∏∞</option>
            <option value="‡∏á‡∏≤‡∏ô‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£">‡∏á‡∏≤‡∏ô‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£</option>
        </select>

        <p><strong>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å:</strong></p>
        <div class="btn-group">
          <button type="button" onclick="toggleInput('electricityDiv', this)">‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤</button>
          <button type="button" onclick="toggleInput('waterDiv', this)">‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ô‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏õ‡∏≤</button>
          <button type="button" onclick="toggleInput('paperDiv', this)">‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©</button>
          <button type="button" onclick="toggleInput('gasLpgDiv', this)">‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Å‡πä‡∏≤‡∏ã‡∏´‡∏∏‡∏á‡∏ï‡πâ‡∏°</button>
          <button type="button" onclick="toggleSubMenu('wasteSubMenu', this)">‡∏Å‡∏≤‡∏£‡∏ó‡∏¥‡πâ‡∏á‡∏Ç‡∏¢‡∏∞</button>
          <button type="button" onclick="toggleSubMenu('oilSubMenu', this)">‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô</button>
        </div>

        <div id="wasteSubMenu" class="sub-btn-group">
            <button type="button" onclick="toggleInput('infectiousWasteDiv', this)">‡∏Ç‡∏¢‡∏∞‡∏ï‡∏¥‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠</button>
            <button type="button" onclick="toggleInput('generalWasteDiv', this)">‡∏Ç‡∏¢‡∏∞‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</button>
            <button type="button" onclick="toggleInput('organicWasteDiv', this)">‡∏Ç‡∏¢‡∏∞‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡∏µ‡∏¢‡πå</button>
        </div>
        
        <div id="oilSubMenu" class="sub-btn-group">
            <button type="button" onclick="toggleInput('dieselVehicleDiv', this)">‡∏î‡∏µ‡πÄ‡∏ã‡∏• (‡∏¢‡∏≤‡∏ô‡∏û‡∏≤‡∏´‡∏ô‡∏∞)</button>
            <button type="button" onclick="toggleInput('dieselMachineDiv', this)">‡∏î‡∏µ‡πÄ‡∏ã‡∏• (‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£)</button>
            <button type="button" onclick="toggleInput('benzinVehicleDiv', this)">‡πÄ‡∏ö‡∏ô‡∏ã‡∏¥‡∏ô (‡∏¢‡∏≤‡∏ô‡∏û‡∏≤‡∏´‡∏ô‡∏∞)</button>
            <button type="button" onclick="toggleInput('benzinMachineDiv', this)">‡πÄ‡∏ö‡∏ô‡∏ã‡∏¥‡∏ô (‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£)</button>
        </div>

        <div id="electricityDiv" class="input-group"><label for="electricity">‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ (kWh/Unit)</label><input type="number" step="0.01" id="electricity" name="electricity" placeholder="‡πÄ‡∏ä‡πà‡∏ô 1500.50"></div>
        <div id="waterDiv" class="input-group"><label for="water">‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ô‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏õ‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏†‡∏π‡∏°‡∏¥‡∏†‡∏≤‡∏Ñ (‡∏•‡∏π‡∏Å‡∏ö‡∏≤‡∏®‡∏Å‡πå‡πÄ‡∏°‡∏ï‡∏£)</label><input type="number" step="0.01" id="water" name="water" placeholder="‡πÄ‡∏ä‡πà‡∏ô 80.25"></div>
        <div id="paperDiv" class="input-group"><label for="paper">‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© A4 (‡∏£‡∏µ‡∏°)</label><input type="number" step="1" id="paper" name="paper" placeholder="‡πÄ‡∏ä‡πà‡∏ô 10"></div>
        <div id="gasLpgDiv" class="input-group"><label for="gasLpg">‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Å‡πä‡∏≤‡∏ã‡∏´‡∏∏‡∏á‡∏ï‡πâ‡∏° (‡∏Å‡∏¥‡πÇ‡∏•‡∏Å‡∏£‡∏±‡∏°)</label><input type="number" step="0.01" id="gasLpg" name="gasLpg" placeholder="‡πÄ‡∏ä‡πà‡∏ô 15.5"></div>
        <div id="infectiousWasteDiv" class="input-group"><label for="infectiousWaste">‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏Ç‡∏¢‡∏∞‡∏ï‡∏¥‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏Å‡∏≥‡∏à‡∏±‡∏î (‡∏Å‡∏¥‡πÇ‡∏•‡∏Å‡∏£‡∏±‡∏°)</label><input type="number" step="0.01" id="infectiousWaste" name="infectiousWaste" placeholder="‡πÄ‡∏ä‡πà‡∏ô 55.50"></div>
        <div id="generalWasteDiv" class="input-group"><label for="generalWaste">‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏Ç‡∏¢‡∏∞‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏Å‡∏≥‡∏à‡∏±‡∏î (‡∏Å‡∏¥‡πÇ‡∏•‡∏Å‡∏£‡∏±‡∏°)</label><input type="number" step="0.01" id="generalWaste" name="generalWaste" placeholder="‡πÄ‡∏ä‡πà‡∏ô 250.75"></div>
        <div id="organicWasteDiv" class="input-group"><label for="organicWaste">‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏Ç‡∏¢‡∏∞‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡∏µ‡∏¢‡πå‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏Å‡∏≥‡∏à‡∏±‡∏î (‡∏Å‡∏¥‡πÇ‡∏•‡∏Å‡∏£‡∏±‡∏°)</label><input type="number" step="0.01" id="organicWaste" name="organicWaste" placeholder="‡πÄ‡∏ä‡πà‡∏ô 120.00"></div>
        <div id="dieselVehicleDiv" class="input-group"><label for="dieselVehicle">‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏î‡∏µ‡πÄ‡∏ã‡∏• - ‡∏¢‡∏≤‡∏ô‡∏û‡∏≤‡∏´‡∏ô‡∏∞ (‡∏•‡∏¥‡∏ï‡∏£)</label><input type="number" step="0.01" id="dieselVehicle" name="dieselVehicle" placeholder="‡πÄ‡∏ä‡πà‡∏ô 120.50"></div>
        <div id="dieselMachineDiv" class="input-group"><label for="dieselMachine">‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏î‡∏µ‡πÄ‡∏ã‡∏• - ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£ (‡∏•‡∏¥‡∏ï‡∏£)</label><input type="number" step="0.01" id="dieselMachine" name="dieselMachine" placeholder="‡πÄ‡∏ä‡πà‡∏ô 150.00"></div>
        <div id="benzinVehicleDiv" class="input-group"><label for="benzinVehicle">‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡πÄ‡∏ö‡∏ô‡∏ã‡∏¥‡∏ô - ‡∏¢‡∏≤‡∏ô‡∏û‡∏≤‡∏´‡∏ô‡∏∞ (‡∏•‡∏¥‡∏ï‡∏£)</label><input type="number" step="0.01" id="benzinVehicle" name="benzinVehicle" placeholder="‡πÄ‡∏ä‡πà‡∏ô 100.25"></div>
        <div id="benzinMachineDiv" class="input-group"><label for="benzinMachine">‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡πÄ‡∏ö‡∏ô‡∏ã‡∏¥‡∏ô - ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£ (‡∏•‡∏¥‡∏ï‡∏£)</label><input type="number" step="0.01" id="benzinMachine" name="benzinMachine" placeholder="‡πÄ‡∏ä‡πà‡∏ô 50.00"></div>

        <button type="submit" class="submit-btn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
      </form>
    </div>

    <!-- Modals -->
    <div id="modal-overlay" class="modal-overlay">
      <div id="loading-modal" class="modal-content">
        <div class="spinner"></div>
        <h3>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</h3>
        <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà</p>
      </div>
      <div id="success-modal" class="modal-content">
        <div class="co2-graphic">
          <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <g class="co2-cloud">
              <circle cx="35" cy="65" r="15"/>
              <circle cx="55" cy="60" r="20"/>
              <circle cx="75" cy="65" r="15"/>
              <text x="55" y="70" font-family="Arial, sans-serif" font-size="18" fill="white" text-anchor="middle" font-weight="bold">CO‚ÇÇ</text>
            </g>
            <path class="leaf" d="M 50,95 C 20,80 20,40 50,10 C 80,40 80,80 50,95 Z" />
            <line class="leaf" x1="50" y1="95" x2="50" y2="40" stroke-linecap="round"/>
          </svg>
        </div>
        <h3>‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏ô‡∏∂‡πà‡∏á ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÇ‡∏•‡∏Å‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô!</h3>
        <p>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢</p>
        <button class="modal-close-btn" onclick="closeModal()">‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°</button>
      </div>
      <div id="alert-modal" class="modal-content alert-modal-content">
        <div class="alert-icon">‚ö†Ô∏è</div>
        <h3>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå</h3>
        <p id="alert-message"></p>
        <button class="modal-close-btn alert-close-btn" onclick="closeModal()">‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö</button>
      </div>
    </div>

    <script>
      const overlay = document.getElementById('modal-overlay');
      const loadingModal = document.getElementById('loading-modal');
      const successModal = document.getElementById('success-modal');
      const alertModal = document.getElementById('alert-modal');
      const alertMessage = document.getElementById('alert-message');

      function toggleInput(divId, button) {
        const div = document.getElementById(divId);
        const isActive = button.classList.contains('active');
        
        if (isActive) {
          div.style.display = "none";
          button.classList.remove("active");
        } else {
          div.style.display = "block";
          button.classList.add("active");
        }
      }

      function toggleSubMenu(subMenuId, mainButton) {
        const subMenu = document.getElementById(subMenuId);
        const isActive = mainButton.classList.contains('active');

        if (isActive) {
          subMenu.style.display = "none";
          mainButton.classList.remove("active");
          // Hide all sub-inputs when closing the sub-menu
          const subButtons = subMenu.querySelectorAll('button');
          subButtons.forEach(button => {
            button.classList.remove('active');
            const onclickAttr = button.getAttribute('onclick');
            const targetDivId = onclickAttr.match(/'([^']+)'/)[1]; 
            const targetDiv = document.getElementById(targetDivId);
            if (targetDiv) {
              targetDiv.style.display = 'none';
            }
          });
        } else {
          subMenu.style.display = "flex";
          mainButton.classList.add("active");
        }
      }
      
      function resetFormToInitialState() {
        document.getElementById('dataForm').reset();
        document.querySelectorAll('.input-group, .sub-btn-group').forEach(div => div.style.display = 'none');
        document.querySelectorAll('.btn-group button, .sub-btn-group button').forEach(btn => btn.classList.remove('active'));
        // Set date to today by default for convenience
        document.getElementById('dataDate').valueAsDate = new Date();
      }
      
      function showAlert(message) {
        alertMessage.textContent = message;
        overlay.style.display = 'flex';
        alertModal.style.display = 'block';
        loadingModal.style.display = 'none';
        successModal.style.display = 'none';
      }

      function submitForm() {
        const dataDate = document.getElementById('dataDate').value;
        const department = document.getElementById('department').value;

        if (!dataDate) {
          showAlert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å");
          return;
        }
        if (!department) {
          showAlert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô");
          return;
        }
        
        const allNumberInputs = document.querySelectorAll('.input-group input[type="number"]');
        let hasData = false;

        for (const input of allNumberInputs) {
            if (input.value && parseFloat(input.value) > 0) {
                hasData = true;
                break; 
            }
        }

        if (!hasData) {
            showAlert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 0)");
            return;
        }
        
        const formData = {
          dataDate: dataDate, 
          department: department,
          electricity: parseFloat(document.getElementById('electricity').value) || 0,
          water: parseFloat(document.getElementById('water').value) || 0,
          paper: parseFloat(document.getElementById('paper').value) || 0,
          gasLpg: parseFloat(document.getElementById('gasLpg').value) || 0,
          infectiousWaste: parseFloat(document.getElementById('infectiousWaste').value) || 0,
          generalWaste: parseFloat(document.getElementById('generalWaste').value) || 0,
          organicWaste: parseFloat(document.getElementById('organicWaste').value) || 0,
          dieselVehicle: parseFloat(document.getElementById('dieselVehicle').value) || 0,
          dieselMachine: parseFloat(document.getElementById('dieselMachine').value) || 0,
          benzinVehicle: parseFloat(document.getElementById('benzinVehicle').value) || 0,
          benzinMachine: parseFloat(document.getElementById('benzinMachine').value) || 0
        };

        overlay.style.display = 'flex';
        loadingModal.style.display = 'block';
        alertModal.style.display = 'none';
        successModal.style.display = 'none';

        // Check if the code is running in the Google Apps Script environment
        if (typeof google !== 'undefined' && google.script && google.script.run) {
          google.script.run
            .withSuccessHandler(response => {
              loadingModal.style.display = 'none';
              successModal.style.display = 'block';
              console.log(response);
            })
            .withFailureHandler(error => {
              loadingModal.style.display = 'none';
              showAlert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å: " + error.message);
              console.error(error);
            })
            .saveData(formData);
        } else {
          // Fallback for local/preview environment where google.script is not available
          console.log("Running in simulation mode. This is expected during local development or preview.");
          // Simulate a successful save for previewing
          setTimeout(() => {
              loadingModal.style.display = 'none';
              successModal.style.display = 'block';
          }, 1500);
        }
      }

      function closeModal() {
        overlay.style.display = 'none';
        successModal.style.display = 'none';
        alertModal.style.display = 'none';
        loadingModal.style.display = 'none';
        resetFormToInitialState();
      }

      // Initialize form on page load
      document.addEventListener('DOMContentLoaded', (event) => {
        resetFormToInitialState();
      });
    </script>
  </body>
</html>
