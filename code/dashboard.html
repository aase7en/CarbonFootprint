<!DOCTYPE html>
<html>
<head>
    <base target="_top">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | Carbon Footprint รพ.อุทัย</title>
    
    <!-- Tailwind CSS for modern styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Charts for data visualization -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    
    <!-- Google Fonts for Thai typography -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* Custom styles to integrate with Tailwind */
        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #f8fafc; /* Tailwind's gray-50 */
        }
        /* Custom styles for Google Charts to match the theme */
        .google-visualization-tooltip {
            font-family: 'Sarabun', sans-serif !important;
            border-radius: 8px !important;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1) !important;
            border: 1px solid #e2e8f0 !important;
        }
        /* Style for table sort indicators */
        .sort-indicator {
            display: inline-block;
            width: 16px;
            height: 16px;
            margin-left: 8px;
            opacity: 0.6;
            transition: opacity 0.2s;
        }
        th:hover .sort-indicator {
            opacity: 1;
        }
    </style>
</head>
<body class="antialiased text-gray-800">

    <div id="loading" class="flex items-center justify-center min-h-screen">
        <div class="text-center">
            <svg class="animate-spin h-8 w-8 text-green-600 mx-auto mb-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <p class="text-lg font-semibold text-gray-600">กำลังโหลดข้อมูลแดชบอร์ด...</p>
        </div>
    </div>

    <div id="content" class="dashboard-container max-w-7xl mx-auto p-4 md:p-6 lg:p-8 hidden">
        <!-- Header Section -->
        <header class="flex flex-col md:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200">
            <div class="flex items-center gap-3">
                 <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-green-700" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L9 9.414V13a1 1 0 102 0V9.414l1.293 1.293a1 1 0 001.414-1.414z" clip-rule="evenodd" /></svg>
                <h1 class="text-2xl md:text-3xl font-bold text-gray-800">Dashboard Carbon Footprint</h1>
            </div>
            <a href="https://aase7en.github.io/CarbonFootprint/" class="mt-4 md:mt-0 w-full md:w-auto inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors" target="_top">
            กลับหน้าบันทึกข้อมูล
            </a>
            <!-- <a href="<?= ScriptApp.getService().getUrl(); ?>" class="mt-4 md:mt-0 w-full md:w-auto inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors">
                กลับหน้าบันทึกข้อมูล
            </a> -->
        </header>

        <!-- Filters Section -->
        <section class="mb-6 p-4 bg-white rounded-lg shadow">
            <h2 class="text-lg font-semibold mb-4 text-gray-700">ตัวกรองข้อมูล</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                <div class="filter-group">
                    <label for="startDate" class="block text-sm font-medium text-gray-700">วันที่เริ่มต้น</label>
                    <input type="date" id="startDate" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500 sm:text-sm">
                </div>
                <div class="filter-group">
                    <label for="endDate" class="block text-sm font-medium text-gray-700">วันที่สิ้นสุด</label>
                    <input type="date" id="endDate" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500 sm:text-sm">
                </div>
                <div class="filter-group">
                    <label for="departmentFilter" class="block text-sm font-medium text-gray-700">แผนก</label>
                    <select id="departmentFilter" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500 sm:text-sm">
                        <option value="">ทุกแผนก</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="activityFilter" class="block text-sm font-medium text-gray-700">กิจกรรม</label>
                    <select id="activityFilter" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500 sm:text-sm">
                        <option value="">ทุกกิจกรรม</option>
                    </select>
                </div>
            </div>
        </section>

        <!-- Summary Cards Section -->
        <section class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <div class="summary-card bg-white p-6 rounded-lg shadow flex items-center gap-4 border-l-4 border-blue-500">
                <div class="bg-blue-100 p-3 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" /></svg></div>
                <div>
                    <h4 class="text-sm font-medium text-gray-500">จำนวนรายการทั้งหมด</h4>
                    <p id="total-records" class="text-3xl font-bold text-gray-800">0</p>
                </div>
            </div>
            <div class="summary-card bg-white p-6 rounded-lg shadow flex items-center gap-4 border-l-4 border-green-500">
                 <div class="bg-green-100 p-3 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7.014A8.003 8.003 0 0117.657 18.657z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.879 16.121A3 3 0 1014.12 11.88l-4.242 4.242z" /></svg></div>
                <div>
                    <h4 class="text-sm font-medium text-gray-500">ปริมาณการปล่อยรวม</h4>
                    <p id="total-emission" class="text-3xl font-bold text-gray-800">0</p>
                    <span class="text-sm text-gray-500">kgCO₂e</span>
                </div>
            </div>
        </section>

        <!-- Main Content: Chart and Table -->
        <main class="grid grid-cols-1 lg:grid-cols-5 gap-6">
            <!-- Chart -->
            <section class="lg:col-span-2 bg-white p-4 rounded-lg shadow">
                 <div id="chart_div" class="w-full h-96"></div>
            </section>
            
            <!-- Table -->
            <section class="lg:col-span-3 bg-white rounded-lg shadow overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-green-800 text-white">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider cursor-pointer" onclick="sortTableByColumn('dataDate', this)">วันที่ข้อมูล <span class="sort-indicator"></span></th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider cursor-pointer" onclick="sortTableByColumn('department', this)">แผนก <span class="sort-indicator"></span></th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider cursor-pointer" onclick="sortTableByColumn('activity', this)">กิจกรรม <span class="sort-indicator"></span></th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider cursor-pointer" onclick="sortTableByColumn('value', this)">ปริมาณ <span class="sort-indicator"></span></th>
                            </tr>
                        </thead>
                        <tbody id="dataTableBody" class="bg-white divide-y divide-gray-200">
                           <!-- Data rows will be inserted here by JavaScript -->
                        </tbody>
                         <tfoot class="bg-gray-100">
                            <tr>
                                <td colspan="3" class="px-6 py-4 text-right font-semibold text-gray-700">ผลรวมย่อย (Subtotal):</td>
                                <td id="subtotal-value" class="px-6 py-4 font-bold text-gray-800">0</td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </section>
        </main>
    </div>

   <script>
    let allData = [];
    let filteredData = [];
    let sortState = { key: 'dataDate', direction: 'desc' };

    // --- ✨ อัปเดตครั้งสุดท้าย ✨ ---
    // Emission Factors ที่ปรับปรุงให้ตรงกับข้อมูลจริงใน Google Sheet ของคุณ 100%
    const emissionFactors = {
        // --- กิจกรรมมาตรฐาน ---
        "การใช้ไฟฟ้า": 0.4984,
        "การใช้น้ำประปาส่วนภูมิภาค": 0.0003,
        "ขยะติดเชื้อ": 0.45,
        "ขยะทั่วไป": 0.584,
        "ขยะอินทรีย์": 0.584,
        "การใช้ก๊าซหุงต้ม": 3.0337,
        
        // --- กิจกรรมที่มาจากข้อมูลเก่า (ตรงตาม Google Sheet) ---
        "ปริมาณดีเซล - ยานพาหนะ": 2.6938,
        "ปริมาณเบนซิน - ยานพาหนะ": 2.2968,
        "ปริมาณดีเซล - เครื่องจักร": 2.6938,
        "ปริมาณเบนซิน - เครื่องจักร": 2.2968,
        "ปริมาณการใช้กระดาษ A4": 1.8375,

        // --- กิจกรรมใหม่ที่เพิ่มเข้ามา ---
        "การใช้สารเคมี คลอรีน": 1.4, // ค่าประมาณการจาก Life Cycle Assessment
        "การใช้หมึก": 3.0, // ค่าประมาณการทั่วไปสำหรับหมึกพิมพ์
    };

    // Map สำหรับแปลงชื่อกิจกรรมเก่าให้เป็นชื่อมาตรฐาน เพื่อการแสดงผลที่สวยงาม
    const activityNameMap = {
        "ปริมาณดีเซล - ยานพาหนะ": "การใช้น้ำมันดีเซล (ยานพาหนะ)",
        "ปริมาณเบนซิน - ยานพาหนะ": "การใช้น้ำมันเบนซิน (ยานพาหนะ)",
        "ปริมาณดีเซล - เครื่องจักร": "การใช้น้ำมันดีเซล (เครื่องจักร)",
        "ปริมาณเบนซิน - เครื่องจักร": "การใช้น้ำมันเบนซิน (เครื่องจักร)",
        "ปริมาณการใช้กระดาษ A4": "การใช้กระดาษ A4",
    };
    // -------------------------

    // --- INITIALIZATION ---
    document.addEventListener("DOMContentLoaded", () => {
        google.charts.load('current', {'packages':['corechart']});
        google.charts.setOnLoadCallback(fetchData);
    });
    
    function fetchData() {
        document.getElementById('loading').style.display = 'flex';
        if (typeof google !== 'undefined' && google.script && google.script.run) {
            google.script.run.withSuccessHandler(dataLoaded).getSheetData();
        } else {
            console.warn("Running in PREVIEW mode. Using mock data.");
            const mockData = [
                ["2025-09-22T12:00:00.000Z", "2025-09-22", "กลุ่มงานบริหารทั่วไป", "ปริมาณการใช้กระดาษ A4", 44, "รีม"],
                ["2025-09-21T12:00:00.000Z", "2025-09-21", "งานซ่อมบำรุง", "ปริมาณเบนซิน - เครื่องจักร", 21, "ลิตร"],
                ["2025-09-20T12:00:00.000Z", "2025-09-20", "กลุ่มการพยาบาล", "การใช้ไฟฟ้า", 60105, "kWh"],
                ["2025-09-19T12:00:00.000Z", "2025-09-19", "กลุ่มงานผู้ป่วยนอก", "การใช้น้ำประปาส่วนภูมิภาค", 89, "ลูกบาศก์เมตร"],
                ["2025-09-18T12:00:00.000Z", "2025-09-18", "กลุ่มงานเภสัชกรรม", "การใช้สารเคมี คลอรีน", 8.5, "ลิตร"]
            ];
            setTimeout(() => dataLoaded(mockData), 800);
        }
    }

    function dataLoaded(dataFromServer) {
        if (dataFromServer.error) {
            document.getElementById('loading').innerHTML = `<p class="text-red-600 font-semibold">เกิดข้อผิดพลาด: ${dataFromServer.message}</p>`;
            return;
        }

        allData = dataFromServer.map(row => {
            const originalActivity = row[3] ? String(row[3]).trim() : '';
            const value = parseFloat(row[4]) || 0;
            const co2e = value * (emissionFactors[originalActivity] || 0);
            const standardizedActivity = activityNameMap[originalActivity] || originalActivity;

            return {
                dataDate: new Date(row[1]),
                department: row[2],
                activity: standardizedActivity,
                value: value,
                unit: row[5],
                co2e: co2e
            };
        }).filter(item => item.department && item.activity);
        
        initializeDashboard();
    }

    function initializeDashboard() {
        populateFilters();
        setupEventListeners();
        setDateRangePreset(30);
        
        document.getElementById('loading').style.display = 'none';
        document.getElementById('content').classList.remove('hidden');
    }

    function populateFilters() {
        const departments = [...new Set(allData.map(item => item.department))].sort((a,b) => a.localeCompare(b, 'th'));
        const activities = [...new Set(allData.map(item => item.activity))].sort((a,b) => a.localeCompare(b, 'th'));
        
        const deptFilter = document.getElementById('departmentFilter');
        deptFilter.innerHTML = '<option value="">ทุกแผนก</option>';
        departments.forEach(dept => deptFilter.add(new Option(dept, dept)));
        
        const activityFilter = document.getElementById('activityFilter');
        activityFilter.innerHTML = '<option value="">ทุกกิจกรรม</option>';
        activities.forEach(activity => activityFilter.add(new Option(activity, activity)));
    }

    function setupEventListeners() {
         ['startDate', 'endDate', 'departmentFilter', 'activityFilter'].forEach(id => {
            document.getElementById(id).addEventListener('change', () => {
                document.querySelectorAll('.date-preset-btn').forEach(btn => btn.classList.remove('active'));
                applyFiltersAndRender();
            });
        });
    }

    function setDateRangePreset(days) {
        const today = new Date();
        today.setHours(23, 59, 59, 999);
        const startDate = new Date(today);
        startDate.setDate(today.getDate() - (days - 1));
        startDate.setHours(0, 0, 0, 0);

        if(days === 0) {
          startDate.setDate(today.getDate());
        }

        document.getElementById('startDate').value = startDate.toISOString().split('T')[0];
        document.getElementById('endDate').value = today.toISOString().split('T')[0];
        
        document.querySelectorAll('.date-preset-btn').forEach((btn, index) => {
            const presetDays = [0, 7, 30, 90, 365];
            if(presetDays[index] === days) btn.classList.add('active');
            else btn.classList.remove('active');
        });

        applyFiltersAndRender();
    }

    function applyFiltersAndRender() {
        const startDate = document.getElementById('startDate').valueAsDate;
        const endDate = document.getElementById('endDate').valueAsDate;
        if (endDate) endDate.setHours(23, 59, 59, 999);
        
        const department = document.getElementById('departmentFilter').value;
        const activity = document.getElementById('activityFilter').value;

        filteredData = allData.filter(item => {
            return (!startDate || item.dataDate >= startDate) &&
                   (!endDate || item.dataDate <= endDate) &&
                   (!department || item.department === department) &&
                   (!activity || item.activity === activity);
        });
        renderAll(filteredData);
    }
    
    function renderAll(data) {
        renderSummaryCards(data);
        renderTable(data);
        renderTrendChart(data);
        renderActivityChart(data);
    }
    
    function renderSummaryCards(data) {
        const totalRecords = data.length;
        const totalEmission = data.reduce((sum, item) => sum + item.co2e, 0);
        
        const dateRange = new Set(data.map(d => d.dataDate.toISOString().split('T')[0]));
        const days = dateRange.size || 1;
        const averageEmission = totalEmission / days;
        
        const deptEmissions = data.reduce((acc, item) => {
            acc[item.department] = (acc[item.department] || 0) + item.co2e;
            return acc;
        }, {});
        const topDepartment = Object.entries(deptEmissions).sort((a,b) => b[1] - a[1])[0];

        document.getElementById('total-records').textContent = totalRecords.toLocaleString('th-TH');
        document.getElementById('total-emission').textContent = totalEmission.toLocaleString('th-TH', { maximumFractionDigits: 2 });
        document.getElementById('average-emission').textContent = averageEmission.toLocaleString('th-TH', { maximumFractionDigits: 2 });
        document.getElementById('top-department').textContent = topDepartment ? topDepartment[0] : '-';
    }
    
    function renderTable(data) {
        const sortedData = [...data].sort((a, b) => {
            const valA = a[sortState.key];
            const valB = b[sortState.key];
            let comparison = (valA > valB) ? 1 : (valA < valB) ? -1 : 0;
            return sortState.direction === 'asc' ? comparison : -comparison;
        });
        updateSortIndicators();

        const tableBody = document.getElementById('dataTableBody');
        if (sortedData.length === 0) {
            tableBody.innerHTML = `<tr><td colspan="5" class="text-center text-gray-500 py-10">ไม่พบข้อมูล</td></tr>`;
            return;
        }
        tableBody.innerHTML = sortedData.map(item => `
            <tr class="hover:bg-gray-50 transition-colors">
                <td class="px-6 py-4 text-sm text-gray-600">${item.dataDate.toLocaleDateString('th-TH', { year: '2-digit', month: 'short', day: 'numeric' })}</td>
                <td class="px-6 py-4 text-sm text-gray-800 font-medium">${item.department}</td>
                <td class="px-6 py-4 text-sm text-gray-600">${item.activity}</td>
                <td class="px-6 py-4 text-sm text-gray-800">${item.value.toLocaleString('th-TH')} ${item.unit}</td>
                <td class="px-6 py-4 text-sm text-gray-800 font-bold">${item.co2e.toFixed(4)}</td>
            </tr>`).join('');
    }

    function renderTrendChart(data) {
        const aggregated = data.reduce((acc, item) => {
            const dateKey = item.dataDate.toLocaleDateString('th-TH', { month: 'short', day: 'numeric' });
            acc[dateKey] = (acc[dateKey] || 0) + item.co2e;
            return acc;
        }, {});
        
        const chartData = [['วันที่', 'kgCO₂e']].concat(Object.entries(aggregated));

        if (chartData.length <= 1) {
            document.getElementById('trend_chart_div').innerHTML = '<div class="flex items-center justify-center h-full text-gray-500">ข้อมูลไม่เพียงพอสำหรับแสดงกราฟแนวโน้ม</div>';
            return;
        }

        const dataTable = google.visualization.arrayToDataTable(chartData);
        const options = {
            title: 'แนวโน้มการปล่อย CO₂e',
            titleTextStyle: { color: '#334155', fontName: 'Sarabun', fontSize: 16, bold: false },
            chartArea: {width: '85%', height: '75%'},
            hAxis: { textStyle: { color: '#64748b', fontName: 'Sarabun', fontSize: 11 } },
            vAxis: { title: 'kgCO₂e', format: 'short', textStyle: { color: '#64748b', fontName: 'Sarabun' } },
            legend: { position: 'none' },
            tooltip: { trigger: 'focus', textStyle: { fontName: 'Sarabun' } },
            colors: [getComputedStyle(document.documentElement).getPropertyValue('--primary-green')],
            animation: { startup: true, duration: 1000, easing: 'out' }
        };
        const chart = new google.visualization.ColumnChart(document.getElementById('trend_chart_div'));
        chart.draw(dataTable, options);
    }

    function renderActivityChart(data) {
        const aggregated = data.reduce((acc, item) => {
            if (item.co2e > 0) {
              acc[item.activity] = (acc[item.activity] || 0) + item.co2e;
            }
            return acc;
        }, {});

        const sorted = Object.entries(aggregated).sort((a,b) => b[1] - a[1]);
        const chartData = [['กิจกรรม', 'kgCO₂e']].concat(sorted);
        
        if (chartData.length <= 1) {
            document.getElementById('activity_chart_div').innerHTML = '<div class="flex items-center justify-center h-full text-gray-500">ไม่มีข้อมูลสำหรับแสดงกราฟสัดส่วน</div>';
            return;
        }

        const dataTable = google.visualization.arrayToDataTable(chartData);
        const options = {
            title: 'สัดส่วนการปล่อย CO₂e ตามกิจกรรม',
            titleTextStyle: { color: '#334155', fontName: 'Sarabun', fontSize: 16, bold: false },
            pieHole: 0.4,
            chartArea: {width: '90%', height: '80%'},
            legend: { position: 'bottom', textStyle: { color: '#475569', fontName: 'Sarabun' } },
            tooltip: { textStyle: { fontName: 'Sarabun' } },
            pieSliceTextStyle: { color: 'black' },
            animation: { startup: true, duration: 1000, easing: 'out' }
        };
        const chart = new google.visualization.PieChart(document.getElementById('activity_chart_div'));
        chart.draw(dataTable, options);
    }
    
    function sortTableByColumn(key, thElement) {
        sortState.key === key ? sortState.direction = (sortState.direction === 'asc' ? 'desc' : 'asc') : (sortState.key = key, sortState.direction = 'asc');
        renderTable(filteredData);
    }

    function updateSortIndicators() {
        document.querySelectorAll('th .sort-indicator').forEach(span => span.innerHTML = '');
        const th = document.querySelector(`th[onclick*="'${sortState.key}'"] .sort-indicator`);
        if (th) th.innerHTML = sortState.direction === 'asc' ? '▲' : '▼';
    }

    function exportToCSV() {
        if (filteredData.length === 0) {
          showToast("ไม่มีข้อมูลสำหรับส่งออก");
          return;
        }
        const headers = "วันที่,แผนก,กิจกรรม,ปริมาณ,หน่วย,CO2e_kg";
        const rows = filteredData.map(d => [
            d.dataDate.toISOString().split('T')[0],
            `"${d.department}"`, `"${d.activity}"`, d.value, d.unit, d.co2e.toFixed(4)
        ].join(','));
        
        const csvContent = "data:text/csv;charset=utf-8," + headers + "\n" + rows.join("\n");
        const encodedUri = encodeURI(csvContent);
        const link = document.createElement("a");
        link.setAttribute("href", encodedUri);
        link.setAttribute("download", `carbon_footprint_export_${new Date().toISOString().slice(0,10)}.csv`);
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        showToast("ส่งออกข้อมูลสำเร็จ");
    }
    
    function refreshData() {
        showToast("กำลังรีเฟรชข้อมูล...");
        fetchData();
    }
    
    function showToast(message) {
        const toast = document.getElementById('toast');
        toast.textContent = message;
        toast.classList.add('show');
        setTimeout(() => { toast.classList.remove('show'); }, 3000);
    }

</script>
</body>
</html>
